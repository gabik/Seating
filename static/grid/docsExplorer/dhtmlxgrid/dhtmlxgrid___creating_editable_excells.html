<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
 lang="en" dir="ltr">
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><link rel="stylesheet" href="../codebase/default.css" type="text/css" media="screen" title="no title" charset="utf-8"><title>
    dhtmlxgrid:creating_editable_excells    [DHX documentation]
  </title></head>

<body>
<div class="dokuwiki">
  
  <div class="stylehead">

    <div class="header">
    <a class="logo" href="http://dhtmlx.com" title="DHTMLX Home Page"></a>
    <span class="tittle-dhtmlx">DHTMLX Docs & Samples Explorer</span>

    <div class="search-field">
        <form action="/dhtmlx/docs/doku.php" accept-charset="utf-8" id="dw__search"><div class="no"><input type="hidden" name="do" value="search" /><input type="text" id="qsearch__in" accesskey="f" name="id" title="Search" /><button type="submit"></button><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>    </div>
        <div class="buttons">
                <a class="doc"></a>
                <a title="DHTMLX Samples homepage" href="../samples.html" class="sample"/></a>
        </div>
     <!-- <div class="pagename">
        [[<a href="#"  title="Backlinks">dhtmlxgrid:creating_editable_excells</a>]]
      </div>
      <div class="logo">
        <a href="/dhtmlx/docs/doku.php"  name="dokuwiki__top" id="dokuwiki__top" accesskey="h" title="[H]">DHX documentation</a>      </div>

      <div class="clearer"></div>-->
        
    </div>

    
<!--   <div class="bar" id="bar__top">
      <div class="bar-left" id="bar__topleft">
        <form class="button btn_edit" method="post" action="/dhtmlx/docs/doku.php"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="" /><input type="hidden" name="id" value="dhtmlxgrid:creating_editable_excells" /><input type="submit" value="Edit this page" class="button" accesskey="e" title="Edit this page [E]" /></div></form>        <form class="button btn_revs" method="get" action="/dhtmlx/docs/doku.php"><div class="no"><input type="hidden" name="do" value="revisions" /><input type="hidden" name="id" value="dhtmlxgrid:creating_editable_excells" /><input type="submit" value="Old revisions" class="button" accesskey="o" title="Old revisions [O]" /></div></form>      </div>

      <div class="bar-right" id="bar__topright">
        <form class="button btn_recent" method="get" action="/dhtmlx/docs/doku.php"><div class="no"><input type="hidden" name="do" value="recent" /><input type="hidden" name="id" value="dhtmlxgrid:creating_editable_excells" /><input type="submit" value="Recent changes" class="button" accesskey="r" title="Recent changes [R]" /></div></form>        <form action="/dhtmlx/docs/doku.php" accept-charset="utf-8" id="dw__search"><div class="no"><input type="hidden" name="do" value="search" /><input type="text" id="qsearch__in" accesskey="f" name="id" title="Search" /><button type="submit"></button><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>&nbsp;
      </div>

      <div class="clearer"></div>
    </div> -->

<!--        <div class="breadcrumbs">
      <span class="bchead">Trace:</span> <span class="bcsep">&raquo;</span> <span class="curid"><a href="/dhtmlx/docs/doku.php?id=dhtmlxgrid:creating_editable_excells"  class="breadcrumbs" title="dhtmlxgrid:creating_editable_excells">creating_editable_excells</a></span>    </div>
    -->

    
  </div>
  
  
  <div class="page">
    <!-- wikipage start -->
    
<p>
<div class='backlinks'><div class='backlink last_backlink'><img src="icons___file.gif"  class="media" alt="" /><a href="../index.html" class="wikilink1" title="start">Index</a></div><div class='arrow'></div><div class='backlink last_backlink'><img src="icons___grid.gif"  class="media" alt="" /><a href="index.html" class="wikilink1" title="dhtmlxgrid:toc">dhtmlxgrid</a></div></div>

</p>

<h2><a name="creating_editable_excells" id="creating_editable_excells">Creating Editable Excells</a></h2>
<div class="level2">

<p>

The editable excells use the same approach, but with a few additional methods.
Lets analyze the simplest case:

</p>
<pre class="code javascript">  <span class="kw2">function</span> eXcell_button<span class="br0">&#40;</span>cell<span class="br0">&#41;</span><span class="br0">&#123;</span>                             <span class="co1">//excell name is defined here</span>
      <span class="kw1">if</span> <span class="br0">&#40;</span>cell<span class="br0">&#41;</span><span class="br0">&#123;</span>                                                     <span class="co1">//default pattern, just copy it</span>
          <span class="kw1">this</span>.<span class="me1">cell</span> <span class="sy0">=</span> cell;
          <span class="kw1">this</span>.<span class="me1">grid</span> <span class="sy0">=</span> <span class="kw1">this</span>.<span class="me1">cell</span>.<span class="me1">parentNode</span>.<span class="me1">grid</span>;
          eXcell_ed.<span class="me1">call</span><span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>;                                <span class="co1">//use methods of &quot;ed&quot; excell</span>
      <span class="br0">&#125;</span>
      <span class="kw1">this</span>.<span class="me1">setValue</span><span class="sy0">=</span><span class="kw2">function</span><span class="br0">&#40;</span>val<span class="br0">&#41;</span><span class="br0">&#123;</span>
          <span class="kw1">this</span>.<span class="me1">setCValue</span><span class="br0">&#40;</span><span class="st0">&quot;&lt;input type='button' value='&quot;</span><span class="sy0">+</span>val<span class="sy0">+</span><span class="st0">&quot;'&gt;&quot;</span><span class="sy0">,</span>val<span class="br0">&#41;</span>;  
      <span class="br0">&#125;</span>
      <span class="kw1">this</span>.<span class="me1">getValue</span><span class="sy0">=</span><span class="kw2">function</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#123;</span>
         <span class="kw1">return</span> <span class="kw1">this</span>.<span class="me1">cell</span>.<span class="me1">firstChild</span>.<span class="me1">value</span>; <span class="co1">// get button label</span>
      <span class="br0">&#125;</span>
  <span class="br0">&#125;</span>
  eXcell_button.<span class="me1">prototype</span> <span class="sy0">=</span> <span class="kw2">new</span> eXcell;    <span class="co1">// nest all other methods from base class</span></pre>
<p>

As result - 3 new methods were added:
</p>
<ul>
<li class="level1"><div class="li">  getValue - returns the current cell value; it may be used by normal <acronym title="Application Programming Interface">API</acronym>, and it is necessary for normal edit operation;</div>
</li>
<li class="level1"><div class="li">  edit - ( not declared explictly, nested from ed excell ) called when the grid is switched to the edit state;</div>
</li>
<li class="level1"><div class="li">  detach - ( not declared explictly, nested from ed excell ) called when the grid is switched back to the normal state. </div>
</li>
</ul>

<p>
In spite of the fact that we have twice as much rows in this example as we had for read-only excell creation, basically we have only one row which needs to be customized. Both edit and detach events are fully reused from the already existing excell.
</p>

<p>
Editable button creation is pretty useless use case, so lets change it into something more usable:

</p>
<pre class="code javascript">  <span class="kw2">function</span> eXcell_myprice<span class="br0">&#40;</span>cell<span class="br0">&#41;</span><span class="br0">&#123;</span>                                    <span class="co1">//excell name is defined here</span>
      <span class="kw1">if</span> <span class="br0">&#40;</span>cell<span class="br0">&#41;</span><span class="br0">&#123;</span>                                                     <span class="co1">//default pattern, just copy it</span>
          <span class="kw1">this</span>.<span class="me1">cell</span> <span class="sy0">=</span> cell;
          <span class="kw1">this</span>.<span class="me1">grid</span> <span class="sy0">=</span> <span class="kw1">this</span>.<span class="me1">cell</span>.<span class="me1">parentNode</span>.<span class="me1">grid</span>;
          eXcell_ed.<span class="me1">call</span><span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>;                                <span class="co1">//use methods of &quot;ed&quot; excell</span>
      <span class="br0">&#125;</span>
      <span class="kw1">this</span>.<span class="me1">setValue</span><span class="sy0">=</span><span class="kw2">function</span><span class="br0">&#40;</span>val<span class="br0">&#41;</span><span class="br0">&#123;</span>
          <span class="kw1">this</span>.<span class="me1">setCValue</span><span class="br0">&#40;</span><span class="st0">&quot;&lt;span&gt;&quot;</span><span class="sy0">+</span>val<span class="sy0">+</span><span class="st0">&quot;&lt;/span&gt;&lt;span&gt; USD&lt;/span&gt;&quot;</span><span class="sy0">,</span>val<span class="br0">&#41;</span>;                                     
      <span class="br0">&#125;</span>
      <span class="kw1">this</span>.<span class="me1">getValue</span><span class="sy0">=</span><span class="kw2">function</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#123;</span>
         <span class="kw1">return</span> <span class="kw1">this</span>.<span class="me1">cell</span>.<span class="me1">childNodes</span><span class="br0">&#91;</span>0<span class="br0">&#93;</span>.<span class="me1">innerHTML</span>; <span class="co1">// get value</span>
      <span class="br0">&#125;</span>
  <span class="br0">&#125;</span>
  eXcell_button.<span class="me1">prototype</span> <span class="sy0">=</span> <span class="kw2">new</span> eXcell;    <span class="co1">// nest all other methods from base class</span></pre>
<p>

As you can see, only the text marked in bold was changed, and now, instead of a useless button we have the value formated with some postfix. This value can be correctly editable as Integer value.
</p>

<p>
In the most complex cases you may need to create an excell with custom editor. In such situation lets see the sample code of excell which can be used for hour selecting, instead of the simple text input. In addition to the default input, cell editor will have an additional time selector:
</p>
<pre class="code javascript">  <span class="kw2">function</span> eXcell_mytime<span class="br0">&#40;</span>cell<span class="br0">&#41;</span><span class="br0">&#123;</span>                                    <span class="co1">//excell name is defined here</span>
      <span class="kw1">if</span> <span class="br0">&#40;</span>cell<span class="br0">&#41;</span><span class="br0">&#123;</span>                                                     <span class="co1">//default pattern, just copy it</span>
          <span class="kw1">this</span>.<span class="me1">cell</span> <span class="sy0">=</span> cell;
          <span class="kw1">this</span>.<span class="me1">grid</span> <span class="sy0">=</span> <span class="kw1">this</span>.<span class="me1">cell</span>.<span class="me1">parentNode</span>.<span class="me1">grid</span>;
      <span class="br0">&#125;</span>
      <span class="kw1">this</span>.<span class="me1">setValue</span><span class="sy0">=</span><span class="kw2">function</span><span class="br0">&#40;</span>val<span class="br0">&#41;</span><span class="br0">&#123;</span>
          <span class="kw1">this</span>.<span class="me1">setCValue</span><span class="br0">&#40;</span>val<span class="br0">&#41;</span>;                                     
      <span class="br0">&#125;</span>
      <span class="kw1">this</span>.<span class="me1">getValue</span><span class="sy0">=</span><span class="kw2">function</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#123;</span>
         <span class="kw1">return</span> <span class="kw1">this</span>.<span class="me1">cell</span>.<span class="me1">innerHTML</span>; <span class="co1">// get value</span>
      <span class="br0">&#125;</span>
      <span class="kw1">this</span>.<span class="me1">edit</span><span class="sy0">=</span><span class="kw2">function</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#123;</span>
          <span class="kw1">this</span>.<span class="me1">val</span> <span class="sy0">=</span> <span class="kw1">this</span>.<span class="me1">getValue</span><span class="br0">&#40;</span><span class="br0">&#41;</span>; <span class="co1">//save current value</span>
          <span class="kw1">this</span>.<span class="me1">cell</span>.<span class="me1">innerHTML</span><span class="sy0">=</span><span class="st0">&quot;&lt;input type='text' style='width:50px;'&gt;&lt;select style='width:50px;'&gt;&lt;option value='AM'&gt;AM&lt;option value='PM'&gt;PM&lt;/select&gt;&quot;</span>; <span class="co1">// editor's html</span>
          <span class="kw1">this</span>.<span class="me1">cell</span>.<span class="me1">firstChild</span>.<span class="me1">value</span><span class="sy0">=</span>parseInt<span class="br0">&#40;</span>val<span class="br0">&#41;</span>; <span class="co1">//set the first part of data</span>
          <span class="kw1">if</span> <span class="br0">&#40;</span>val.<span class="me1">indexOf</span><span class="br0">&#40;</span><span class="st0">&quot;PM&quot;</span><span class="br0">&#41;</span><span class="sy0">!=-</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw1">this</span>.<span class="me1">cell</span>.<span class="me1">childNodes</span><span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">value</span><span class="sy0">=</span><span class="st0">&quot;PM&quot;</span>;
&nbsp;
&nbsp;
&nbsp;
            <span class="kw1">this</span>.<span class="me1">cell</span>.<span class="me1">childNodes</span><span class="br0">&#91;</span>0<span class="br0">&#93;</span>.<span class="me1">onclick</span><span class="sy0">=</span><span class="kw2">function</span><span class="br0">&#40;</span>e<span class="br0">&#41;</span><span class="br0">&#123;</span> <span class="br0">&#40;</span>e||event<span class="br0">&#41;</span>.<span class="me1">cancelBubble</span><span class="sy0">=</span><span class="kw2">true</span>; <span class="br0">&#125;</span> <span class="co1">//block onclick event</span>
            <span class="kw1">this</span>.<span class="me1">cell</span>.<span class="me1">childNodes</span><span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">onclick</span><span class="sy0">=</span><span class="kw2">function</span><span class="br0">&#40;</span>e<span class="br0">&#41;</span><span class="br0">&#123;</span> <span class="br0">&#40;</span>e||event<span class="br0">&#41;</span>.<span class="me1">cancelBubble</span><span class="sy0">=</span><span class="kw2">true</span>; <span class="br0">&#125;</span> <span class="co1">//block onclick event</span>
      <span class="br0">&#125;</span>
      <span class="kw1">this</span>.<span class="me1">detach</span><span class="sy0">=</span><span class="kw2">function</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#123;</span>
          <span class="kw1">this</span>.<span class="me1">setValue</span><span class="br0">&#40;</span><span class="kw1">this</span>.<span class="me1">cell</span>.<span class="me1">childNodes</span><span class="br0">&#91;</span>0<span class="br0">&#93;</span>.<span class="me1">value</span><span class="sy0">+</span><span class="st0">&quot; &quot;</span><span class="sy0">+</span><span class="kw1">this</span>.<span class="me1">cell</span>.<span class="me1">childNodes</span><span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">value</span><span class="br0">&#41;</span>; <span class="co1">//set the new value</span>
          <span class="kw1">return</span> <span class="kw1">this</span>.<span class="me1">val</span><span class="sy0">!=</span><span class="kw1">this</span>.<span class="me1">getValue</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;    <span class="co1">// compare the new and the old values</span>
      <span class="br0">&#125;</span>
  <span class="br0">&#125;</span>
  eXcell_mytime.<span class="me1">prototype</span> <span class="sy0">=</span> <span class="kw2">new</span> eXcell;    <span class="co1">// nest all other methods from base class</span></pre>
<p>

As you can see this sample contains some additional code, but there is still nothing really complex.<br/>

<acronym title="HyperText Markup Language">HTML</acronym> code of editor is defined inside “edit” method, thus the editor is filled with current values.<br/>

Values from the editor are combined to get a new cell value inside “detach” method.
</p>

</div>
<div class="secedit"><form class="button btn_secedit" method="post" action="/dhtmlx/docs/doku.php"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="lines" value="53-" /><input type="hidden" name="rev" value="1279031287" /><input type="hidden" name="id" value="dhtmlxgrid:creating_editable_excells" /><input type="submit" value="Edit" class="button" title="Creating Editable Excells" /></div></form></div>
    <!-- wikipage stop -->
  </div>

  <div class="clearer">&nbsp;</div>

  
  <div class="stylefoot">

    <div class="meta">
      <div class="user">
              </div>
     <!-- <div class="doc">
        dhtmlxgrid/creating_editable_excells.txt &middot; Last modified: 2010/07/13 17:28 (external edit)      </div>
    </div>-->

   
    <!--<div class="bar" id="bar__bottom">-->
      <!--<div class="bar-left" id="bar__bottomleft">-->
        <!--<form class="button btn_edit" method="post" action="/dhtmlx/docs/doku.php"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="" /><input type="hidden" name="id" value="dhtmlxgrid:creating_editable_excells" /><input type="submit" value="Edit this page" class="button" accesskey="e" title="Edit this page [E]" /></div></form>-->
        <!--<form class="button btn_revs" method="get" action="/dhtmlx/docs/doku.php"><div class="no"><input type="hidden" name="do" value="revisions" /><input type="hidden" name="id" value="dhtmlxgrid:creating_editable_excells" /><input type="submit" value="Old revisions" class="button" accesskey="o" title="Old revisions [O]" /></div></form>-->
      <!--</div>-->
      <!--<div class="bar-right" id="bar__bottomright">-->
        <!---->
        <!---->
        <!---->
        <!---->
        <!---->
        <!--<form class="button btn_index" method="get" action="/dhtmlx/docs/doku.php"><div class="no"><input type="hidden" name="do" value="index" /><input type="hidden" name="id" value="dhtmlxgrid:creating_editable_excells" /><input type="submit" value="Index" class="button" accesskey="x" title="Index [X]" /></div></form>-->
        <!--<a class="nolink" href="#dokuwiki__top"><input type="button" class="button" value="Back to top" onclick="window.scrollTo(0, 0)" title="Back to top" /></a>&nbsp;-->
      <!--</div>-->
      <!--<div class="clearer"></div>-->
    <!--</div>-->

  </div>

  

</div>

<div class="footerinc">


</div>

<div class="no"><img src="/dhtmlx/docs/lib/exe/indexer.php?id=dhtmlxgrid%3Acreating_editable_excells&amp;1310069469" width="1" height="1" alt=""  /></div>
     <div class="footer">
        <div class="footer-logo"></div>
        <div class="copyright">Copyright © 1998-2011 DHTMLX LTD.<br />All rights reserved.</div>
        <form class="button btn_edit" method="post" action="/dhtmlx/docs/doku.php"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="" /><input type="hidden" name="id" value="dhtmlxgrid:creating_editable_excells" /><input type="submit" value="Edit this page" class="button" accesskey="e" title="Edit this page [E]" /></div></form>    	    </div>
</body>
</html>
